<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Para mi personita especial ‚ù§Ô∏è</title>
    <style>
        :root {
            --rosa: #ff85a2;
            --rosa-oscuro: #8a0e2a;
            --rosa-claro: #ffb3c1;
            --rojo: #ff4d6d;
        }

        body {
            margin: 0;
            padding: 0;
            background: var(--rosa);
            background-image: radial-gradient(var(--rosa-claro) 20%, transparent 20%);
            background-size: 40px 40px;
            font-family: 'Courier New', Courier, Consolas, monospace;
            overflow: hidden;
            height: 100vh;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            touch-action: manipulation;
        }

        /* Corazones flotando de fondo */
        .corazon-flotante {
            position: absolute;
            font-size: 1.2rem;
            color: rgba(255, 105, 180, 0.7);
            pointer-events: none;
            animation: flotar linear infinite;
            z-index: 1;
        }

        @keyframes flotar {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0.6; }
            100% { transform: translateY(-20vh) rotate(360deg); opacity: 0; }
        }

        /* TEL√ìN */
        #telon {
            position: fixed;
            inset: 0;
            z-index: 100;
            display: flex;
            cursor: pointer;
            user-select: none;
        }

        .panel {
            width: 50%;
            height: 100%;
            background: var(--rosa-oscuro);
            transition: transform 1.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: inset 0 0 120px rgba(0,0,0,0.7);
            will-change: transform;
        }

        .panel-izq { border-right: 6px solid #500010; }
        .panel-der { border-left: 6px solid #500010; }

        .texto-telon {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            z-index: 101;
            pointer-events: none;
            transition: opacity 0.7s;
            text-shadow: 3px 3px 12px black;
        }

        .texto-telon h1 {
            font-size: clamp(2.8rem, 9vw, 4.5rem);
            margin: 0;
            letter-spacing: 6px;
        }

        /* CARTA + FINAL */
        #carta, #final {
            background: white;
            padding: 25px;
            border: 9px solid var(--rojo);
            border-radius: 18px;
            text-align: center;
            box-shadow: 0 25px 60px rgba(0,0,0,0.45);
            max-width: 360px;
            width: 90%;
            z-index: 10;
            opacity: 0;
            transform: scale(0.7);
            transition: all 1.2s ease 0.5s;
            position: relative;
        }

        .mostrar { opacity: 1; transform: scale(1); }

        .foto-wrapper {
            width: 100%;
            height: 220px;
            margin-bottom: 20px;
            background: #fff0f3;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }

        .foto-pareja {
            width: 100%;
            height: 100%;
            object-fit: cover;
            position: absolute;
            top: 0; left: 0;
            opacity: 0;
            transition: opacity 1.2s;
        }

        .foto-pareja.activa { opacity: 1; }

        #texto-maquina {
            font-size: 16.5px;
            color: #590d22;
            font-weight: bold;
            min-height: 100px;
            margin: 0 0 25px;
            line-height: 1.5;
            white-space: pre-wrap;
        }

        .botones { display: flex; justify-content: center; gap: 25px; flex-wrap: wrap; }

        button {
            padding: 14px 36px;
            font-size: 1.15rem;
            font-weight: bold;
            border: 3px solid black;
            cursor: pointer;
            border-radius: 14px;
            transition: all 0.2s;
        }

        #btnSi {
            background: #70e000;
            box-shadow: 0 6px 0 #38b000;
            color: white;
            animation: latir 1.4s infinite ease-in-out;
        }

        #btnSi:hover { transform: scale(1.12); }

        @keyframes latir {
            0%, 100% { transform: scale(1); }
            50%      { transform: scale(1.09); }
        }

        #btnNo {
            background: var(--rojo);
            box-shadow: 0 6px 0 #c9184a;
            color: white;
        }

        #btnMusica {
            margin-top: 15px;
            padding: 10px 20px;
            font-size: 1rem;
            background: #ff69b4;
            color: white;
            border: none;
        }

        .particula {
            position: fixed;
            pointer-events: none;
            z-index: 9999;
            font-size: 2rem;
            animation: volar 1.4s forwards;
        }

        @keyframes volar {
            to { transform: translate(var(--x), var(--y)) scale(0.1) rotate(720deg); opacity: 0; }
        }

        #final h2 {
            font-size: 2.2rem;
            color: var(--rojo);
            margin: 20px 0;
            text-shadow: 2px 2px 10px rgba(0,0,0,0.3);
        }

        .abierto .panel-izq { transform: translateX(-100%); }
        .abierto .panel-der { transform: translateX(100%); }
        .abierto .texto-telon { opacity: 0; }

        @media (max-width: 420px) {
            button { padding: 12px 30px; font-size: 1rem; }
            #texto-maquina { font-size: 15px; }
        }
    </style>
</head>
<body>

    <audio id="musica" loop preload="auto">
        <source src="https://files.freemusicarchive.org/storage-freemusicarchive-org/music/ccCommunity/Kai_Engel/Chapter_One__Cold/Kai_Engel_-_04_-_Moonlight_Reprise.mp3" type="audio/mpeg">
    </audio>

    <!-- Corazones flotando -->
    <div id="corazones-fondo"></div>

    <div id="telon">
        <div class="panel panel-izq"></div>
        <div class="texto-telon">
            <h1>¬øVALENTINE?</h1>
            <p style="font-size: 1.4rem; margin-top: 15px;">Toca para abrir mi amor ‚ù§Ô∏è</p>
        </div>
        <div class="panel panel-der"></div>
    </div>

    <div id="carta" class="container">
        <div class="foto-wrapper" id="slideshow">
            <!-- Fotos se agregan con JS -->
        </div>
        
        <div id="texto-maquina" aria-live="polite"></div>
        
        <div class="botones">
            <button id="btnSi">S√ç</button>
            <button id="btnNo">NO</button>
        </div>

        <button id="btnMusica">üéµ M√∫sica ON</button>
    </div>

    <div id="final" class="container" style="display:none;">
        <h2>¬°Sab√≠a que dir√≠as que S√ç! üíç‚ù§Ô∏è</h2>
        <p style="font-size: 1.3rem; color: #590d22; margin: 20px 0;">
            Sos lo m√°s hermoso que me pas√≥ en la vida.<br>
            Te amo infinitamente, mi gorda preciosa üíï<br>
            Siempre juntos ‚ôæÔ∏è
        </p>
        <div id="confeti-final"></div>
    </div>

    <script>
        // --- Configuraci√≥n f√°cil de cambiar ---
        const fotos = ["foto1.jpg", "foto2.jpg", "foto3.jpg"]; // agrega las que tengas (m√≠nimo 1)
        const mensaje = "¬øQuer√©s ser mi VALENTINE? Sos la MEJOR persona del mundo. Te amo infinitamente üíï";
        const frasesNo = ["¬øSegura? ü•∫", "Pi√©nsalo bien mi amor...", "¬°Me rompes el corazoncito!", "No pod√©s decirme que no...", "¬°Epa! Te quiero igual üò≠üíï"];
        const MAX_MOVIMIENTOS = 7;

        // Elementos
        const musica = document.getElementById('musica');
        const btnMusica = document.getElementById('btnMusica');
        const telon = document.getElementById('telon');
        const carta = document.getElementById('carta');
        const finalScreen = document.getElementById('final');
        const textoDiv = document.getElementById('texto-maquina');
        const btnSi = document.getElementById('btnSi');
        const btnNo = document.getElementById('btnNo');
        const slideshow = document.getElementById('slideshow');

        let yaAbierto = false;
        let movimientosNo = 0;
        let musicaOn = true;

        // Corazones flotando
        function crearCorazones() {
            const container = document.getElementById('corazones-fondo');
            for (let i = 0; i < 18; i++) {
                const corazon = document.createElement('div');
                corazon.classList.add('corazon-flotante');
                corazon.textContent = ['‚ù§Ô∏è','üíó','üíñ','üíû'][Math.floor(Math.random()*4)];
                corazon.style.left = Math.random() * 100 + 'vw';
                corazon.style.animationDuration = (8 + Math.random() * 12) + 's';
                corazon.style.animationDelay = Math.random() * 5 + 's';
                container.appendChild(corazon);
            }
        }

        // Slideshow fotos
        function initSlideshow() {
            if (fotos.length === 0) return;
            let index = 0;
            fotos.forEach((src, i) => {
                const img = document.createElement('img');
                img.src = src;
                img.alt = "Nosotros ‚ù§Ô∏è";
                img.classList.add('foto-pareja');
                if (i === 0) img.classList.add('activa');
                img.onerror = () => { img.src = 'https://via.placeholder.com/340x220/ff69b4/fff?text=Te+Amo+üíï'; };
                slideshow.appendChild(img);
            });

            if (fotos.length > 1) {
                setInterval(() => {
                    const imgs = slideshow.querySelectorAll('.foto-pareja');
                    imgs[index].classList.remove('activa');
                    index = (index + 1) % fotos.length;
                    imgs[index].classList.add('activa');
                }, 5000);
            }
        }

        // Abrir
        function abrirTodo(e) {
            if (yaAbierto) return;
            yaAbierto = true;
            e.preventDefault();

            telon.classList.add('abierto');
            carta.classList.add('mostrar');

            setTimeout(() => {
                musica.play().catch(() => {});
            }, 1000);

            let i = 0;
            textoDiv.textContent = "";
            function escribir() {
                if (i < mensaje.length) {
                    textoDiv.textContent += mensaje[i++];
                    setTimeout(escribir, 45);
                }
            }
            setTimeout(escribir, 800);
        }

        // Mover NO
        function moverNo(e) {
            e.preventDefault();
            if (movimientosNo >= MAX_MOVIMIENTOS) return;
            movimientosNo++;

            const maxX = window.innerWidth - btnNo.offsetWidth - 40;
            const maxY = window.innerHeight - btnNo.offsetHeight - 40;
            const x = Math.random() * maxX;
            const y = Math.random() * maxY;

            btnNo.style.position = "fixed";
            btnNo.style.left = x + "px";
            btnNo.style.top = y + "px";
            btnNo.textContent = frasesNo[Math.floor(Math.random() * frasesNo.length)];
        }

        // Celebrar + final
        function celebrar(e) {
            e.preventDefault();
            const touch = e.touches?.[0] ?? e;
            const x = touch?.clientX ?? window.innerWidth / 2;
            const y = touch?.clientY ?? window.innerHeight / 2;

            const iconos = ["‚ù§Ô∏è","üíó","üíñ","‚ú®","üå∏","ü•∞","üíï","üåπ"];
            for (let i = 0; i < 70; i++) {
                const p = document.createElement('div');
                p.textContent = iconos[Math.floor(Math.random() * iconos.length)];
                p.classList.add('particula');
                p.style.left = x + 'px';
                p.style.top = y + 'px';
                p.style.setProperty('--x', (Math.random() - 0.5) * 900 + 'px');
                p.style.setProperty('--y', (Math.random() - 0.5) * 900 + 'px');
                document.body.appendChild(p);
                setTimeout(() => p.remove(), 1600);
            }

            setTimeout(() => {
                carta.style.display = 'none';
                finalScreen.style.display = 'block';
                finalScreen.classList.add('mostrar');

                // Confeti final
                for (let i = 0; i < 40; i++) {
                    setTimeout(() => {
                        const p = document.createElement('div');
                        p.classList.add('particula');
                        p.textContent = iconos[Math.floor(Math.random() * iconos.length)];
                        p.style.left = Math.random() * 100 + 'vw';
                        p.style.top = '-10vh';
                        p.style.setProperty('--x', (Math.random() - 0.5) * 400 + 'px');
                        p.style.setProperty('--y', '120vh');
                        document.body.appendChild(p);
                        setTimeout(() => p.remove(), 5000);
                    }, i * 120);
                }
            }, 1400);
        }

        // Control m√∫sica
        btnMusica.addEventListener('click', () => {
            if (musicaOn) {
                musica.pause();
                btnMusica.textContent = "üéµ OFF";
            } else {
                musica.play().catch(() => {});
                btnMusica.textContent = "üéµ ON";
            }
            musicaOn = !musicaOn;
        });

        // Iniciar
        crearCorazones();
        initSlideshow();

        // Eventos
        telon.addEventListener('click', abrirTodo);
        telon.addEventListener('touchstart', abrirTodo, { passive: false });

        btnNo.addEventListener('pointerenter', moverNo);
        btnNo.addEventListener('touchstart', moverNo, { passive: false });

        btnSi.addEventListener('click', celebrar);
        btnSi.addEventListener('touchstart', celebrar, { passive: false });
    </script>
</body>
</html>
